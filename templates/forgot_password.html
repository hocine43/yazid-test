{% extends "base.html" %}
{% block title %}Mot de passe oubli√©{% endblock %}
{% block content %}

<div class="max-w-5xl mx-auto mt-20 grid grid-cols-1 md:grid-cols-2 gap-8 px-4">

  <!-- Section mot de passe oubli√© -->
  <div class="bg-white border rounded-lg shadow-md p-8">
    <h2 class="text-2xl font-bold text-gray-800 mb-2 uppercase">üîë MOT DE PASSE OUBLI√â</h2>

    {% if not step %}
      <p class="text-gray-600 mb-6">
        Entrez votre adresse email ci-dessous. Un code de v√©rification vous sera envoy√© pour r√©initialiser votre mot de passe.
      </p>

      <!-- √âtape 1 : Email -->
      <form method="post">
        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
        <label class="block mb-2 font-semibold text-gray-700">E-MAIL *</label>
        <input name="email" type="email" placeholder="Entrez votre email" required
               class="w-full p-2.5 border border-gray-300 rounded-md mb-4 bg-gray-50 focus:ring-2 focus:ring-green-400 focus:outline-none">

        <div class="flex items-center space-x-3">
          <a href="{{ url_for('login') }}" 
             class="border border-gray-400 text-gray-700 px-4 py-2 rounded-md hover:bg-gray-100 transition">
            Retour
          </a>
          <button type="submit" 
                  class="bg-green-500 text-white font-semibold px-6 py-2 rounded-md hover:bg-green-600 transition">
            Envoyer le code
          </button>
        </div>
      </form>

    {% elif step == 'verify' %}
      <!-- √âtape 2 : V√©rifier le code -->
      <p class="text-gray-600 mb-6">
        Un code √† 6 chiffres a √©t√© envoy√© √† <strong>{{ email }}</strong>.  
        Entrez-le ci-dessous pour confirmer votre identit√©.
      </p>

      <form method="post">
        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
        <input type="hidden" name="email" value="{{ email }}">
        <label class="block mb-2 font-semibold text-gray-700">Code de v√©rification *</label>
        <input name="code" type="text" maxlength="6" placeholder="------" required
               class="w-full text-center text-lg tracking-widest p-2.5 border border-gray-300 rounded-md mb-4 bg-gray-50 focus:ring-2 focus:ring-green-400 focus:outline-none">

        <div class="flex items-center space-x-3">
          <a href="{{ url_for('forgot_password') }}" 
             class="border border-gray-400 text-gray-700 px-4 py-2 rounded-md hover:bg-gray-100 transition">
            ‚¨Ö Retour
          </a>
          <button type="submit" 
                  class="bg-green-500 text-white font-semibold px-6 py-2 rounded-md hover:bg-green-600 transition">
            V√©rifier
          </button>
        </div>
      </form>

    {% elif step == 'reset' %}
      <!-- √âtape 3 : Nouveau mot de passe -->
      <p class="text-gray-600 mb-6">
        Entrez votre nouveau mot de passe pour compl√©ter la r√©initialisation.
      </p>

      <form method="post">
        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
        <input type="hidden" name="email" value="{{ email }}">
        <label class="block mb-2 font-semibold text-gray-700">Nouveau mot de passe *</label>
        <input name="new_password" type="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required
               class="w-full p-2.5 border border-gray-300 rounded-md mb-4 bg-gray-50 focus:ring-2 focus:ring-green-400 focus:outline-none">

        <div class="flex items-center space-x-3">
          <a href="{{ url_for('login') }}" 
             class="border border-gray-400 text-gray-700 px-4 py-2 rounded-md hover:bg-gray-100 transition">
            Annuler
          </a>
          <button type="submit" 
                  class="bg-green-500 text-white font-semibold px-6 py-2 rounded-md hover:bg-green-600 transition">
            R√©initialiser
          </button>
        </div>
      </form>
    {% endif %}
  </div>

  <!-- Section nouveau utilisateur -->
  <div class="bg-white border rounded-lg shadow-md p-8 flex flex-col justify-center">
    <h2 class="text-2xl font-bold text-gray-800 mb-3 uppercase">üßç‚Äç‚ôÇÔ∏è NOUVEAU UTILISATEUR</h2>
    <p class="text-gray-600 mb-6">
      En cr√©ant un compte chez nous, vous pouvez consulter et suivre vos formations dans votre espace personnel et bien plus encore.
    </p>
    <a href="{{ url_for('register') }}" 
       class="bg-green-500 text-white font-semibold px-6 py-2 rounded-md text-center hover:bg-green-600 transition">
      CR√âER UN COMPTE
    </a>
  </div>

</div>

{% endblock %}
